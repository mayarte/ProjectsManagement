@model MainSite.Models.ShowProjectContent
@{
    ViewBag.Title = Model.Project.Name;
}

<h2>@Model.Project.Name</h2>


@using (Html.BeginForm())
{
    <hr />
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    @Html.ValueFor(model => model.ErrorMsg)
    @Html.HiddenFor(x => x.Project.ID);
    <div class="ProjectDiv">
        <table class="BlueTable">
            <tr>
                <td>
                    اسم المشروع
                </td>
                <td>
                    @Html.EditorFor(model => model.Project.Name, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Project.Name, "", new { @class = "text-danger" })
                </td>
            </tr>
            <tr>
                <td>
                    مختصر عن المشروع
                </td>
                <td>
                    @Html.TextAreaFor(model => model.Project.Description, new { @class = "MultiLineTextArea" })
                    @Html.ValidationMessageFor(model => model.Project.Description, "", new { @class = "text-danger" })
                </td>
            </tr>
            <tr>
                <td>
                    السنة الدراسية
                </td>
                <td>
                    @Html.DropDownListFor(model => model.YearID, new SelectList(Model.Years, "ID", ""), new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.Project.Year, "", new { @class = "text-danger" })
                </td>
            </tr>
            <tr>
                <td>
                    نسبة الانجاز
                </td>
                <td>
                    @Html.EditorFor(model => model.Project.ProgressPercentage, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Project.ProgressPercentage, "", new { @class = "text-danger" })
                </td>
            </tr>
            <tr>
                <td>
                    حالة المشروع
                </td>
                <td>
                    @Html.EnumDropDownListFor(model => model.Project.ProjectStatus, htmlAttributes: new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.Project.ProjectStatus, "", new { @class = "text-danger" })
                </td>
            </tr>
            <tr>
                <td>
                    حالة القيد
                </td>
                <td>
                    @Html.EnumDropDownListFor(model => model.Project.Status, htmlAttributes: new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.Project.Status, "", new { @class = "text-danger" })
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <input type="submit" value="حفظ التعديلات" class="btn btn-default" />
                </td>
            </tr>
        </table>

        قائمة المستخدمين ذو الصلة بهذا المشروع
        @foreach (var user in Model.Links)
        {
            <table class="BlueTable">
                <tr>
                    <td>
                        الاسم
                    </td>
                    <td>
                        @Html.ValueFor(model => user.User.Name)
                    </td>
                    <td>
                        نوع الصلة
                    </td>
                    <td>
                        @Html.ValueFor(model => user.LinkType)
                    </td>
                </tr>
            </table>
        }
    </div>
    <div class="ProjectDiv">
        @if (((List<string>)Session["MyClearance"]).Contains("AddPost"))
        {
            @Html.ActionLink("اضافة منشور", "AddPost", "Projects", new { id = Model.Project.ID }, new { @class = "myButtonGray" })
        }
        <p></p>
        @foreach (var pst in Model.Posts)
        {
            <div class="ProjectDiv">
                <table class="BlueTable">
                    <tr>
                        <td colspan="6">
                            @switch (pst.PostType)
                            {
                                case Entity.MyData.PostTypesEnum.Text:
                                    @Html.ValueFor(model => pst.Text)
                                    break;
                                case Entity.MyData.PostTypesEnum.Image:
                                    <img src="@Url.Content(Model.UploadPath+pst.Text)" alt="IMAGES" width="400" height="300" />
                                    break;
                                case Entity.MyData.PostTypesEnum.YouTubeLink:
                                    @(new HtmlString(@pst.Text))
                                    break;
                                case Entity.MyData.PostTypesEnum.WebLink:
                                    <a href="@pst.Text" target="_blank">Link</a>
                                    break;
                                case Entity.MyData.PostTypesEnum.File:
                                    <a href="@Url.Content(Model.UploadPath+pst.Text)">Download</a>
                                    break;
                            }
                        </td>
                    </tr>
                    <tr>
                        <td>
                            معلومات اضافية
                        </td>
                        <td colspan="5">
                            @Html.ValueFor(model => pst.MoreInfo)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            نشر بواسطة
                        </td>
                        <td>
                            @Html.ValueFor(model => pst.PostedBy.Name)
                        </td>
                        <td>
                            تاريخ النشر
                        </td>
                        <td>
                            @Html.ValueFor(model => pst.CreationDate)
                        </td>
                        <td>
                            تاريخ اخر تعديل
                        </td>
                        <td>
                            @Html.ValueFor(model => pst.LastUpdateTime)
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            تعديل
                        </td>
                        <td colspan="3">
                            حذف
                        </td>
                    </tr>
                </table>
            </div>
        }
    </div>
    <br />
    @Html.ActionLink("رجوع الى قائمة المشاريع", "ProjectList", "Projects", null, new { @class = "myButtonGray" })
    @Html.ActionLink("رجوع الى قائمة مشاريعي", "MyProjects", "Projects", null, new { @class = "myButtonGray" })
}

